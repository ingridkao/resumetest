{"version":3,"file":"js/194.bcc0b7ae.js","mappings":"0QACIA,EAAAA,EAAAA,IAKM,YAJSC,EAAAA,OAAAA,EAAAA,EAAAA,OAAXD,EAAAA,EAAAA,IAA2B,MAAAE,EAAV,SACDD,EAAAA,cAAAA,EAAAA,EAAAA,OAAhBD,EAAAA,EAAAA,IAAkD,MAAAG,GAAAC,EAAAA,EAAAA,IAAnBH,EAAAA,aAAW,MAA1C,WACND,EAAAA,EAAAA,IAAgC,MAAAK,GAAAD,EAAAA,EAAAA,IAAlBH,EAAAA,YAAU,K,CAK1B,MAAMK,EAAW,oFACXC,EAAU,0CACVC,EAAYC,gCACZC,EAAgBD,uCACtB,OACIE,OACI,MAAO,CACZC,YAAa,GACJC,MAAM,EACfC,YAAa,GACJC,WAAW,GACpBC,KAAM,UACNC,OAAO,CACN,QAAY,OACZ,KAAS,IAGR,EACDC,QAAQ,CACVC,yBACC,MAAMC,EAAY,IAAIC,gBAAgB,CACrC,CAAC,aAAc,sBACf,CAAC,YAAab,GACd,CAAC,gBAAiBE,KAGnB,OAAOY,KAAKC,MAAM,CACjBC,OAAQ,OACRC,IAAKnB,EACLoB,QAAS,CAAE,eAAgB,qCAC3Bf,KAAMS,IACJO,MAAMC,IACRN,KAAKV,YAAcgB,EAASjB,IAA5B,IACEkB,OAAOC,IACTR,KAAKR,YAAcgB,EAAIF,QAAvB,GAED,EACDG,gBACC,GAAIvB,GAAcE,EAAlB,CAKA,GAAKY,KAAKV,aAAeU,KAAKV,YAAYoB,aAQ1C,OAJAV,KAAKT,MAAO,EACZS,KAAKP,WAAa,GAGXO,KAAKC,MAAMU,IAAK,GAAE1B,yBAA+Be,KAAKN,OAAQ,CACpEU,QAAS,CACRQ,cAAgB,UAASZ,KAAKV,YAAYoB,gBAE3Cf,OAAQK,KAAKL,SACXU,MAAMC,IACRN,KAAKP,WAAaa,EAASjB,IAA3B,IACEkB,OAAOC,IACTR,KAAKR,YAAcgB,EAAIF,QAAvB,IACEO,SAAQ,KACEb,KAAKT,MAAO,CAAZ,IAjBZS,KAAKR,YAAc,6BAHpB,MAFCQ,KAAKR,YAAc,4BAwBrB,GAEDsB,sBAEOd,KAAKH,+BAELG,KAAKS,eACZ,G,QC1ED,MAAMM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://resume202209/./src/views/tdx/Token.vue","webpack://resume202209/./src/views/tdx/Token.vue?a7a1"],"sourcesContent":["<template>\n    <div>\n        <div v-if=\"load\">Load</div>\n        <div v-else-if=\"sourceError\">{{sourceError}}</div>\n\t\t<div v-else>{{sourceData}}</div>\n\t\t<!-- ToDo: 如果之後多個頁面要接Map，建議將地圖變成組件，將資料用props傳到地圖組件裡 -->\n    </div>\n</template>\n<script>\nconst AUTH_URL = \"https://tdx.transportdata.tw/auth/realms/TDXConnect/protocol/openid-connect/token\"\nconst API_URL = 'https://tdx.transportdata.tw/api/basic/'\nconst CLIENT_ID = process.env.VUE_APP_CLIENT_ID || null\nconst CLIENT_SECRET = process.env.VUE_APP_CLIENT_SECRET || null\nexport default {\n    data(){\n        return {\n\t\t\taccesstoken: '',\n            load: false,\n\t\t\tsourceError: '',\n            sourceData:[],\n\t\t\tcity: 'Taoyuan',\n\t\t\tparams:{\n\t\t\t\t'$format' : 'JSON',\n\t\t\t\t'$top' : 30,\n\t\t\t}\n        }\n    },\n    methods:{\n\t\tgetAuthorizationHeader(){\n\t\t\tconst parameter = new URLSearchParams([\n\t\t\t\t['grant_type', 'client_credentials'],\n\t\t\t\t['client_id', CLIENT_ID],\n\t\t\t\t['client_secret', CLIENT_SECRET]\n\t\t\t])\n\t\t\t//這邊要記得return\n\t\t\treturn this.axios({\n\t\t\t\tmethod: \"POST\",\n\t\t\t\turl: AUTH_URL,\n\t\t\t\theaders: { \"content-type\": \"application/x-www-form-urlencoded\" },   \n\t\t\t\tdata: parameter\n\t\t\t}).then((response) => {\n\t\t\t\tthis.accesstoken = response.data\n\t\t\t}).catch((err) => {\n\t\t\t\tthis.sourceError = err.response\n\t\t\t})\n\t\t},\n\t\tgetSourceData(){\n\t\t\tif(!CLIENT_ID || !CLIENT_SECRET){\n\t\t\t\tthis.sourceError = '要輸入CLIENT_ID和CLIENT_SECRET'\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// https://tdx.transportdata.tw/api-service/swagger/basic/2cc9b888-a592-496f-99de-9ab35b7fb70d#/Bike/BikeApi_Station_2180\n\t\t\tif(!(this.accesstoken && this.accesstoken.access_token)){\n\t\t\t\tthis.sourceError = '沒有token，每個呼叫來源端IP的上限為每日50次。'\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.load = true\n\t\t\tthis.sourceData = []\n\t\t\t//這邊要記得return\n\t\t\t//https://tdx.transportdata.tw/api/basic/v2/Bike/Station/City/Taichung?%24top=30&%24format=JSON\n\t\t\treturn this.axios.get(`${API_URL}v2/Bike/Station/City/${this.city}`, {\n\t\t\t\theaders: {\n\t\t\t\t\tauthorization: `Bearer ${this.accesstoken.access_token}`,\n\t\t\t\t},\n\t\t\t\tparams: this.params\n\t\t\t}).then((response) => {\n\t\t\t\tthis.sourceData = response.data\n\t\t\t}).catch((err) => {\n\t\t\t\tthis.sourceError = err.response\n\t\t\t}).finally(() =>{\n                this.load = false\n            })\n\t\t}\n    },\n\tasync created(){\n\t\t//在async之內的作用域\n\t\tawait this.getAuthorizationHeader()\n\t\t//會等getAuthorizationHeader裡面的promise做完事情在做下一個getSourceData\n\t\tawait this.getSourceData()\n\t}\n}\n</script>","import { render } from \"./Token.vue?vue&type=template&id=3dc578b2\"\nimport script from \"./Token.vue?vue&type=script&lang=js\"\nexport * from \"./Token.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/gaoxiaogui_tuic/Documents/iii_org/resume202209/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","$data","_hoisted_1","_hoisted_2","_toDisplayString","_hoisted_3","AUTH_URL","API_URL","CLIENT_ID","process","CLIENT_SECRET","data","accesstoken","load","sourceError","sourceData","city","params","methods","getAuthorizationHeader","parameter","URLSearchParams","this","axios","method","url","headers","then","response","catch","err","getSourceData","access_token","get","authorization","finally","async","__exports__","render"],"sourceRoot":""}